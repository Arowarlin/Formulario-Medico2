<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario M√©dico - UASD</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #1e40af 0%, #7c3aed 50%, #db2777 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; }
        .card { background: white; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.2); padding: 30px; margin-bottom: 20px; border-top: 5px solid #7c3aed; }
        h1 { text-align: center; background: linear-gradient(135deg, #1e40af, #7c3aed, #db2777); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 10px; font-size: 32px; font-weight: bold; }
        .subtitle { text-align: center; color: #6b7280; margin-bottom: 10px; font-size: 14px; }
        .author { text-align: center; color: #1e40af; font-weight: bold; margin-bottom: 20px; font-size: 16px; }
        h2 { color: #1f2937; margin-bottom: 20px; font-size: 24px; display: flex; align-items: center; gap: 10px; }
        .progress { display: flex; justify-content: space-between; margin-bottom: 40px; }
        .progress-step { flex: 1; display: flex; flex-direction: column; align-items: center; }
        .progress-circle { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; background: #d1d5db; color: #6b7280; transition: all 0.3s ease; }
        .progress-circle.active { background: linear-gradient(135deg, #7c3aed, #db2777); color: white; box-shadow: 0 4px 12px rgba(124, 58, 237, 0.4); }
        .progress-circle.completed { background: linear-gradient(135deg, #10b981, #059669); color: white; }
        .progress-label { font-size: 11px; margin-top: 5px; text-align: center; }
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .form-group { margin-bottom: 15px; }
        .form-group.full { grid-column: 1 / -1; }
        label { display: block; font-weight: 500; color: #374151; margin-bottom: 5px; font-size: 14px; }
        input, textarea, select { width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px; }
        input:focus, textarea:focus { outline: none; border-color: #7c3aed; box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.2); }
        .section { display: none; }
        .section.active { display: block; }
        .btn { padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500; display: inline-flex; align-items: center; gap: 8px; transition: all 0.3s ease; }
        .btn-primary { background: linear-gradient(135deg, #7c3aed, #db2777); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(124, 58, 237, 0.4); }
        .btn-success { background: linear-gradient(135deg, #10b981, #059669); color: white; }
        .btn-success:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4); }
        .btn-secondary { background: linear-gradient(135deg, #6b7280, #4b5563); color: white; }
        .btn-secondary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(107, 114, 128, 0.4); }
        .btn-danger { background: linear-gradient(135deg, #ef4444, #dc2626); color: white; }
        .btn-danger:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(239, 68, 68, 0.4); }
        .btn:disabled { background: #d1d5db; cursor: not-allowed; }
        .btn-nav { display: flex; justify-content: space-between; margin-top: 30px; }
        .detalle-box { background: linear-gradient(135deg, #eff6ff, #f3e8ff); border: 2px solid #c4b5fd; border-radius: 8px; padding: 15px; margin-bottom: 15px; }
        .detalle-item { background: white; border: 1px solid #e5e7eb; border-radius: 6px; padding: 12px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
        .detalle-item:hover { background: #f9fafb; }
        .detalle-actions { display: flex; gap: 8px; }
        .icon-btn { background: none; border: none; cursor: pointer; padding: 5px; }
        .icon-btn:hover { opacity: 0.7; }
        .resumen-section { background: white; border: 1px solid #e5e7eb; border-radius: 6px; padding: 15px; margin-bottom: 15px; }
        .resumen-section h3 { margin-bottom: 10px; font-size: 18px; }
        .registro-item { border: 1px solid #e5e7eb; border-radius: 6px; padding: 15px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
        .registro-item:hover { background: #f9fafb; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <h1>üìã Formulario M√©dico Multi-P√°gina</h1>
            <p class="subtitle">Universidad Aut√≥noma de Santo Domingo (UASD)</p>
            <p class="author">üë®‚Äçüíª Arowarlin Suarez</p>
            
            <div class="progress">
                <div class="progress-step">
                    <div class="progress-circle active" id="step1">1</div>
                    <span class="progress-label">Datos Personales</span>
                </div>
                <div class="progress-step">
                    <div class="progress-circle" id="step2">2</div>
                    <span class="progress-label">Familiares</span>
                </div>
                <div class="progress-step">
                    <div class="progress-circle" id="step3">3</div>
                    <span class="progress-label">Condiciones</span>
                </div>
                <div class="progress-step">
                    <div class="progress-circle" id="step4">4</div>
                    <span class="progress-label">Internamientos</span>
                </div>
                <div class="progress-step">
                    <div class="progress-circle" id="step5">5</div>
                    <span class="progress-label">Resumen</span>
                </div>
            </div>

            <div id="page1" class="section active">
                <h2>üë§ Datos Personales</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Nombre Completo *</label>
                        <input type="text" id="nombreCompleto" placeholder="Ej: Juan P√©rez">
                    </div>
                    <div class="form-group">
                        <label>C√©dula *</label>
                        <input type="text" id="cedula" placeholder="001-1234567-8">
                    </div>
                    <div class="form-group">
                        <label>Fecha de Nacimiento *</label>
                        <input type="date" id="fechaNacimiento">
                    </div>
                    <div class="form-group">
                        <label>Tel√©fono *</label>
                        <input type="tel" id="telefono" placeholder="809-555-1234">
                    </div>
                    <div class="form-group full">
                        <label>Direcci√≥n *</label>
                        <textarea id="direccion" rows="2" placeholder="Calle, n√∫mero, sector, ciudad"></textarea>
                    </div>
                </div>
            </div>

            <div id="page2" class="section">
                <h2>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Familiares</h2>
                <div class="detalle-box">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Nombre</label>
                            <input type="text" id="familiarNombre" placeholder="Ej: Dionisio Silverio">
                        </div>
                        <div class="form-group">
                            <label>Parentesco</label>
                            <input type="text" id="familiarParentesco" placeholder="Ej: Padre">
                        </div>
                        <div class="form-group">
                            <label>Edad</label>
                            <input type="number" id="familiarEdad" placeholder="84">
                        </div>
                    </div>
                    <button class="btn btn-success" onclick="agregarFamiliar()">‚ûï Agregar Familiar</button>
                </div>
                <div id="listaFamiliares"></div>
            </div>

            <div id="page3" class="section">
                <h2>‚ù§Ô∏è Condiciones Pre-Existentes</h2>
                <div class="detalle-box">
                    <div class="form-group">
                        <label>Enfermedad *</label>
                        <input type="text" id="condicionEnfermedad" placeholder="Ej: Hipertensi√≥n Arterial">
                    </div>
                    <div class="form-group">
                        <label>Tiempo con la Enfermedad *</label>
                        <input type="text" id="condicionTiempo" placeholder="Ej: 5 a√±os">
                    </div>
                    <div class="form-group">
                        <label>Tratamiento Actual</label>
                        <textarea id="condicionTratamiento" rows="2" placeholder="Medicamentos o tratamientos"></textarea>
                    </div>
                    <button class="btn btn-danger" onclick="agregarCondicion()">‚ûï Agregar Condici√≥n</button>
                </div>
                <div id="listaCondiciones"></div>
            </div>

            <div id="page4" class="section">
                <h2>üè• Internamientos Realizados</h2>
                <div class="detalle-box">
                    <div class="form-group">
                        <label>Fecha *</label>
                        <input type="date" id="internamientoFecha">
                    </div>
                    <div class="form-group">
                        <label>Centro M√©dico *</label>
                        <input type="text" id="internamientoCentro" placeholder="Ej: Hospital General">
                    </div>
                    <div class="form-group">
                        <label>Diagn√≥stico *</label>
                        <textarea id="internamientoDiagnostico" rows="2" placeholder="Motivo del internamiento"></textarea>
                    </div>
                    <button class="btn btn-primary" style="background: linear-gradient(135deg, #9333ea, #7c3aed)" onclick="agregarInternamiento()">‚ûï Agregar Internamiento</button>
                </div>
                <div id="listaInternamientos"></div>
            </div>

            <div id="page5" class="section">
                <h2>üìÑ Resumen de Datos</h2>
                <div id="resumenContenido"></div>
            </div>

            <div class="btn-nav">
                <button class="btn btn-secondary" id="btnAnterior" onclick="anteriorPagina()">‚¨ÖÔ∏è Anterior</button>
                <button class="btn btn-primary" id="btnSiguiente" onclick="siguientePagina()">Siguiente ‚û°Ô∏è</button>
                <button class="btn btn-success hidden" id="btnGuardar" onclick="guardarRegistro()">üíæ Guardar</button>
            </div>
        </div>

        <div class="card" id="registrosGuardados" style="display:none;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2>üìö Registros Guardados (<span id="cantidadRegistros">0</span>)</h2>
                <button class="btn btn-primary" onclick="descargarJSON()">‚¨áÔ∏è Descargar JSON</button>
            </div>
            <div id="listaRegistros"></div>
        </div>
    </div>

    <script>
        let paginaActual = 1;
        let registroActual = {
            datosPersonales: {},
            familiares: [],
            condiciones: [],
            internamientos: []
        };
        let registros = [];
        let editandoIndice = -1;

        function actualizarProgreso() {
            for (let i = 1; i <= 5; i++) {
                const circle = document.getElementById(`step${i}`);
                circle.classList.remove('active', 'completed');
                if (i === paginaActual) circle.classList.add('active');
                else if (i < paginaActual) circle.classList.add('completed');
            }
        }

        function mostrarPagina(num) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(`page${num}`).classList.add('active');
            paginaActual = num;
            actualizarProgreso();

            document.getElementById('btnAnterior').disabled = (num === 1);
            document.getElementById('btnSiguiente').classList.toggle('hidden', num === 5);
            document.getElementById('btnGuardar').classList.toggle('hidden', num !== 5);

            if (num === 5) mostrarResumen();
        }

        function siguientePagina() {
            if (paginaActual === 1 && !validarDatosPersonales()) {
                alert('Complete todos los campos obligatorios');
                return;
            }
            if (paginaActual === 3 && registroActual.condiciones.length === 0) {
                alert('Debe agregar al menos una condici√≥n pre-existente');
                return;
            }
            if (paginaActual < 5) mostrarPagina(paginaActual + 1);
        }

        function anteriorPagina() {
            if (paginaActual > 1) mostrarPagina(paginaActual - 1);
        }

        function validarDatosPersonales() {
            registroActual.datosPersonales = {
                nombreCompleto: document.getElementById('nombreCompleto').value,
                cedula: document.getElementById('cedula').value,
                fechaNacimiento: document.getElementById('fechaNacimiento').value,
                telefono: document.getElementById('telefono').value,
                direccion: document.getElementById('direccion').value
            };
            return Object.values(registroActual.datosPersonales).every(v => v.trim() !== '');
        }

        function agregarFamiliar() {
            const nombre = document.getElementById('familiarNombre').value;
            const parentesco = document.getElementById('familiarParentesco').value;
            const edad = document.getElementById('familiarEdad').value;
            
            if (nombre && parentesco && edad) {
                registroActual.familiares.push({ nombre, parentesco, edad });
                document.getElementById('familiarNombre').value = '';
                document.getElementById('familiarParentesco').value = '';
                document.getElementById('familiarEdad').value = '';
                renderizarFamiliares();
            }
        }

        function renderizarFamiliares() {
            const lista = document.getElementById('listaFamiliares');
            lista.innerHTML = registroActual.familiares.map((f, i) => `
                <div class="detalle-item">
                    <div>
                        <strong>${f.nombre}</strong><br>
                        <small>${f.parentesco} - ${f.edad} a√±os</small>
                    </div>
                    <div class="detalle-actions">
                        <button class="icon-btn" onclick="eliminarFamiliar(${i})">üóëÔ∏è</button>
                    </div>
                </div>
            `).join('');
        }

        function eliminarFamiliar(i) {
            registroActual.familiares.splice(i, 1);
            renderizarFamiliares();
        }

        function agregarCondicion() {
            const enfermedad = document.getElementById('condicionEnfermedad').value;
            const tiempo = document.getElementById('condicionTiempo').value;
            const tratamiento = document.getElementById('condicionTratamiento').value;
            
            if (enfermedad && tiempo) {
                registroActual.condiciones.push({ enfermedad, tiempo, tratamiento });
                document.getElementById('condicionEnfermedad').value = '';
                document.getElementById('condicionTiempo').value = '';
                document.getElementById('condicionTratamiento').value = '';
                renderizarCondiciones();
            }
        }

        function renderizarCondiciones() {
            const lista = document.getElementById('listaCondiciones');
            lista.innerHTML = registroActual.condiciones.map((c, i) => `
                <div class="detalle-item">
                    <div>
                        <strong>${c.enfermedad}</strong><br>
                        <small>Tiempo: ${c.tiempo}</small>
                        ${c.tratamiento ? `<br><small>Tratamiento: ${c.tratamiento}</small>` : ''}
                    </div>
                    <div class="detalle-actions">
                        <button class="icon-btn" onclick="eliminarCondicion(${i})">üóëÔ∏è</button>
                    </div>
                </div>
            `).join('');
        }

        function eliminarCondicion(i) {
            registroActual.condiciones.splice(i, 1);
            renderizarCondiciones();
        }

        function agregarInternamiento() {
            const fecha = document.getElementById('internamientoFecha').value;
            const centroMedico = document.getElementById('internamientoCentro').value;
            const diagnostico = document.getElementById('internamientoDiagnostico').value;
            
            if (fecha && centroMedico && diagnostico) {
                registroActual.internamientos.push({ fecha, centroMedico, diagnostico });
                document.getElementById('internamientoFecha').value = '';
                document.getElementById('internamientoCentro').value = '';
                document.getElementById('internamientoDiagnostico').value = '';
                renderizarInternamientos();
            }
        }

        function renderizarInternamientos() {
            const lista = document.getElementById('listaInternamientos');
            lista.innerHTML = registroActual.internamientos.map((int, i) => `
                <div class="detalle-item">
                    <div>
                        <strong>${int.centroMedico}</strong><br>
                        <small>Fecha: ${int.fecha}</small><br>
                        <small>Diagn√≥stico: ${int.diagnostico}</small>
                    </div>
                    <div class="detalle-actions">
                        <button class="icon-btn" onclick="eliminarInternamiento(${i})">üóëÔ∏è</button>
                    </div>
                </div>
            `).join('');
        }

        function eliminarInternamiento(i) {
            registroActual.internamientos.splice(i, 1);
            renderizarInternamientos();
        }

        function mostrarResumen() {
            const dp = registroActual.datosPersonales;
            const html = `
                <div class="resumen-section">
                    <h3>üë§ Datos Personales</h3>
                    <p><strong>Nombre:</strong> ${dp.nombreCompleto}</p>
                    <p><strong>C√©dula:</strong> ${dp.cedula}</p>
                    <p><strong>Fecha Nacimiento:</strong> ${dp.fechaNacimiento}</p>
                    <p><strong>Tel√©fono:</strong> ${dp.telefono}</p>
                    <p><strong>Direcci√≥n:</strong> ${dp.direccion}</p>
                </div>
                <div class="resumen-section">
                    <h3>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Familiares (${registroActual.familiares.length})</h3>
                    ${registroActual.familiares.map(f => `<p>‚Ä¢ ${f.nombre} - ${f.parentesco}, ${f.edad} a√±os</p>`).join('')}
                </div>
                <div class="resumen-section">
                    <h3>‚ù§Ô∏è Condiciones Pre-Existentes (${registroActual.condiciones.length})</h3>
                    ${registroActual.condiciones.map(c => `<p>‚Ä¢ ${c.enfermedad} (${c.tiempo})</p>`).join('')}
                </div>
                <div class="resumen-section">
                    <h3>üè• Internamientos (${registroActual.internamientos.length})</h3>
                    ${registroActual.internamientos.map(i => `<p>‚Ä¢ ${i.centroMedico} - ${i.fecha}</p>`).join('')}
                </div>
            `;
            document.getElementById('resumenContenido').innerHTML = html;
        }

        function guardarRegistro() {
            if (editandoIndice >= 0) {
                registros[editandoIndice] = JSON.parse(JSON.stringify(registroActual));
                alert('‚úÖ Registro actualizado');
                editandoIndice = -1;
            } else {
                registros.push(JSON.parse(JSON.stringify(registroActual)));
                alert('‚úÖ Registro guardado exitosamente');
            }
            
            limpiarFormulario();
            mostrarPagina(1);
            renderizarListaRegistros();
        }

        function limpiarFormulario() {
            registroActual = {
                datosPersonales: {},
                familiares: [],
                condiciones: [],
                internamientos: []
            };
            document.querySelectorAll('input, textarea').forEach(el => el.value = '');
            renderizarFamiliares();
            renderizarCondiciones();
            renderizarInternamientos();
        }

        function renderizarListaRegistros() {
            if (registros.length === 0) {
                document.getElementById('registrosGuardados').style.display = 'none';
                return;
            }
            
            document.getElementById('registrosGuardados').style.display = 'block';
            document.getElementById('cantidadRegistros').textContent = registros.length;
            
            const html = registros.map((reg, i) => `
                <div class="registro-item">
                    <div>
                        <strong>${reg.datosPersonales.nombreCompleto}</strong><br>
                        <small>C√©dula: ${reg.datosPersonales.cedula}</small><br>
                        <small>${reg.familiares.length} familiares | ${reg.condiciones.length} condiciones | ${reg.internamientos.length} internamientos</small>
                    </div>
                    <div class="detalle-actions">
                        <button class="btn btn-primary" onclick="editarRegistro(${i})">‚úèÔ∏è Editar</button>
                        <button class="btn btn-danger" onclick="eliminarRegistro(${i})">üóëÔ∏è Eliminar</button>
                    </div>
                </div>
            `).join('');
            
            document.getElementById('listaRegistros').innerHTML = html;
        }

        function editarRegistro(i) {
            registroActual = JSON.parse(JSON.stringify(registros[i]));
            editandoIndice = i;
            
            const dp = registroActual.datosPersonales;
            document.getElementById('nombreCompleto').value = dp.nombreCompleto;
            document.getElementById('cedula').value = dp.cedula;
            document.getElementById('fechaNacimiento').value = dp.fechaNacimiento;
            document.getElementById('telefono').value = dp.telefono;
            document.getElementById('direccion').value = dp.direccion;
            
            renderizarFamiliares();
            renderizarCondiciones();
            renderizarInternamientos();
            
            mostrarPagina(1);
            window.scrollTo(0, 0);
        }

        function eliminarRegistro(i) {
            if (confirm('¬øEst√° seguro de eliminar este registro?')) {
                registros.splice(i, 1);
                renderizarListaRegistros();
            }
        }

        function descargarJSON() {
            const json = JSON.stringify(registros, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'registros_formulario.json';
            a.click();
        }

        actualizarProgreso();
    </script>
</body>
</html>